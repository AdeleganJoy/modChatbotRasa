<!DOCTYPE html>
<html>
<head>
    <title>Minimal Chat Test</title>
</head>
<body>
    <div id="chat-box"></div>
    <input type="text" id="user-input">
    <button id="send-button">Send</button>

    <script>
        document.getElementById('send-button').onclick = function() {
            const userMessage = document.getElementById('user-input').value;
            if (!userMessage.trim()) return;

            fetch('https://2911-2001-14bb-11e-c0e6-c4f0-fa5a-c62f-51b3.ngrok-free.app/webhooks/rest/webhook', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ "sender": "user", "message": userMessage })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const contentType = response.headers.get("content-type");
                if (!contentType || !contentType.includes("application/json")) {
                    throw new TypeError("Expected JSON, but received non-JSON");
                }
                return response.json();
            })
            .then(data => {
                console.log(data);
                if (data && data.length > 0 && data[0].text) {
                    document.getElementById('chat-box').innerHTML += '<p>Bot: ' + data[0].text + '</p>';
                } else {
                    document.getElementById('chat-box').innerHTML += '<p>Bot: No response received.</p>';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('chat-box').innerHTML += '<p>Error: ' + error.message + '</p>';
            });

            document.getElementById('user-input').value = ''; // Clear input
        };
    </script>
</body>
</html>
